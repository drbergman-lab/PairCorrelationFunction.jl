<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · PairCorrelationFunction.jl</title><meta name="title" content="Home · PairCorrelationFunction.jl"/><meta property="og:title" content="Home · PairCorrelationFunction.jl"/><meta property="twitter:title" content="Home · PairCorrelationFunction.jl"/><meta name="description" content="Documentation for PairCorrelationFunction.jl."/><meta property="og:description" content="Documentation for PairCorrelationFunction.jl."/><meta property="twitter:description" content="Documentation for PairCorrelationFunction.jl."/><meta property="og:url" content="https://drbergman-lab.github.io/PairCorrelationFunction.jl/"/><meta property="twitter:url" content="https://drbergman-lab.github.io/PairCorrelationFunction.jl/"/><link rel="canonical" href="https://drbergman-lab.github.io/PairCorrelationFunction.jl/"/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>PairCorrelationFunction.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/drbergman-lab/PairCorrelationFunction.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/drbergman-lab/PairCorrelationFunction.jl/blob/main/docs/src/index.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="PairCorrelationFunction"><a class="docs-heading-anchor" href="#PairCorrelationFunction">PairCorrelationFunction</a><a id="PairCorrelationFunction-1"></a><a class="docs-heading-anchor-permalink" href="#PairCorrelationFunction" title="Permalink"></a></h1><p>Documentation for <a href="https://github.com/drbergman-lab/PairCorrelationFunction.jl">PairCorrelationFunction</a>.</p><ul><li><a href="#PairCorrelationFunction.Constants"><code>PairCorrelationFunction.Constants</code></a></li><li><a href="#PairCorrelationFunction.PCFResult"><code>PairCorrelationFunction.PCFResult</code></a></li><li><a href="#PairCorrelationFunction._histcounts_include_min!-Tuple{Vector{Int64}, Vector{Float64}, AbstractRange{&lt;:Real}}"><code>PairCorrelationFunction._histcounts_include_min!</code></a></li><li><a href="#PairCorrelationFunction.pcf-Tuple{AbstractMatrix{&lt;:Real}, AbstractMatrix{&lt;:Real}, Constants}"><code>PairCorrelationFunction.pcf</code></a></li><li><a href="#PairCorrelationFunction.pcfplot"><code>PairCorrelationFunction.pcfplot</code></a></li></ul><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PairCorrelationFunction.Constants" href="#PairCorrelationFunction.Constants"><code>PairCorrelationFunction.Constants</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Constants(xlims::Tuple{Float64, Float64}, ylims::Tuple{Float64, Float64}[, zlims::Tuple{Float64, Float64}], dr::Real)</code></pre><p>A struct to hold the constants needed for the pair correlation function calculation.</p><p>The vector of radii that define the concentric annuli must have constant spacing. You may either pass in the spacing <code>dr</code> or a range of radii in the form <code>r0:dr:rf</code>.</p><p><strong>Fields</strong></p><ul><li><code>grid_size::NTuple{N, Float64}</code>: The size of the grid in each dimension.</li><li><code>base_point::NTuple{N, Float64}</code>: The base point of the grid to be used to calculate distance to the boundary.</li><li><code>domain_volume::Float64</code>: The volume of the domain.</li><li><code>radii::AbstractRange{&lt;:Real}</code>: The range of radii to be used for the pair correlation function.</li><li><code>radii2::AbstractVector{&lt;:Real}</code>: The squared values of the radii.</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">using PairCorrelationFunction
xlims = (-450.0, 450.0)
ylims = (-450.0, 450.0)
radii = 0:20.0:1300.0
constants = Constants(xlims, ylims, radii)
# output
Constants for 2D pair correlation function:
  grid_size: (900.0, 900.0)
  base_point: (-450.0, -450.0)
  domain_volume: 810000.0
  radii: 0.0 - 1300.0
  #annuli: 65</code></pre><pre><code class="language-julia hljs">using PairCorrelationFunction
xlims = (-450.0, 450.0)
ylims = (-450.0, 450.0)
zlims = (-450.0, 450.0)
dr = 100.0
constants = Constants(xlims, ylims, zlims, dr)
# output
Constants for 3D pair correlation function:
  grid_size: (900.0, 900.0, 900.0)
  base_point: (-450.0, -450.0, -450.0)
  domain_volume: 7.29e8
  radii: 0.0 - 1600.0
  #annuli: 16</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/drbergman-lab/PairCorrelationFunction.jl/blob/41c5f537c3acb4af5e9948daa801aec034d302eb/src/PairCorrelationFunction.jl#L80-L125">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PairCorrelationFunction.PCFResult" href="#PairCorrelationFunction.PCFResult"><code>PairCorrelationFunction.PCFResult</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">PCFResult</code></pre><p>A struct to hold the results of the pair correlation function calculation.</p><p>For a single sample/timepoint, the <code>g</code> field will be a vector of pair correlation function values. For multiple samples/timepoints, the <code>g</code> field will be a matrix where each column corresponds to a sample/timepoint.</p><p>The <code>hcat</code> function is overloaded to allow for easy concatenation of multiple <code>PCFResult</code> objects. See example below.</p><p><strong>Fields</strong></p><ul><li><code>radii::AbstractVector{&lt;:Real}</code>: The range of radii used for the pair correlation function.</li><li><code>g::AbstractArray{Float64}</code>: The pair correlation function values for each radius, possibly over many samples/timepoints.</li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs">using PairCorrelationFunction
radii = [0.0, 1.0, 2.0]
g = [0.5, 1.2]
PairCorrelationFunction.PCFResult(radii, g)
# output
PCFResult:
  Radii: 0.0 - 2.0 with 2 annuli
  g: 0.5 - 1.2 (min - max)</code></pre><pre><code class="language-julia hljs">using PairCorrelationFunction
radii = 0.0:1.0:2.0
result_1 = PairCorrelationFunction.PCFResult(radii, [0.5, 1.2])
result_2 = PairCorrelationFunction.PCFResult(radii, [0.6, 1.3])
result_3 = PairCorrelationFunction.PCFResult(radii, [0.8, 1.4])
hcat(result_1, result_2, result_3)
# output
PCFResult:
  #timepoints: 3
  Radii: 0.0 - 2.0 with 2 annuli
  g: 0.5 - 1.4 (min - max)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/drbergman-lab/PairCorrelationFunction.jl/blob/41c5f537c3acb4af5e9948daa801aec034d302eb/src/PairCorrelationFunction.jl#L9-L47">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PairCorrelationFunction._histcounts_include_min!-Tuple{Vector{Int64}, Vector{Float64}, AbstractRange{&lt;:Real}}" href="#PairCorrelationFunction._histcounts_include_min!-Tuple{Vector{Int64}, Vector{Float64}, AbstractRange{&lt;:Real}}"><code>PairCorrelationFunction._histcounts_include_min!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">_histcounts_include_min!(N::Vector{Int}, x::Vector{Float64}, xedges::AbstractRange{&lt;:Real})</code></pre><p>Like <code>histcounts!</code>, but includes the minimum edge of the histogram in the first bin.</p><p>This function relies on <code>xedges[1]==0.0</code> and the input <code>x</code> being all distances to guarantee no value is less than 0. Users can pass in radii with any upper bound and nothing stops the targets from being outside the domain, so we cannot guarantee that the maximum value of <code>x</code> is less than or equal to the maximum value of <code>xedges</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/drbergman-lab/PairCorrelationFunction.jl/blob/41c5f537c3acb4af5e9948daa801aec034d302eb/src/PairCorrelationFunction.jl#L223-L230">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PairCorrelationFunction.pcf-Tuple{AbstractMatrix{&lt;:Real}, AbstractMatrix{&lt;:Real}, Constants}" href="#PairCorrelationFunction.pcf-Tuple{AbstractMatrix{&lt;:Real}, AbstractMatrix{&lt;:Real}, Constants}"><code>PairCorrelationFunction.pcf</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">pcf(centers::AbstractMatrix{&lt;:Real}, targets::AbstractMatrix{&lt;:Real}, constants::Constants)</code></pre><p>Calculate the pair correlation function for a set of centers and targets.</p><p>For each point in the <code>centers</code> matrix, compute the distance to each point in the <code>targets</code> matrix. Bin these distances by the radii defined in the <code>constants</code> object. If <code>targets</code> is not provided, the function will use <code>centers</code> as both centers and targets. Technically, this is the traditional pcf. The version with <code>centers</code> and <code>targets</code> is the cross-PCF.</p><p><strong>Arguments</strong></p><ul><li><code>centers::AbstractMatrix{&lt;:Real}</code>: A matrix of centers, where each row is a center.</li><li><code>targets::AbstractMatrix{&lt;:Real}</code>: A matrix of targets, where each row is a target.</li><li><code>constants::Constants</code>: A <code>Constants</code> object containing the grid size, base point, domain volume, and radii.</li></ul><p><strong>Returns</strong></p><ul><li><code>PCFResult</code>: A struct with the radii and the pair correlation function values.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/drbergman-lab/PairCorrelationFunction.jl/blob/41c5f537c3acb4af5e9948daa801aec034d302eb/src/PairCorrelationFunction.jl#L170-L188">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PairCorrelationFunction.pcfplot" href="#PairCorrelationFunction.pcfplot"><code>PairCorrelationFunction.pcfplot</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">pcfplot</code></pre><p>Plot the pair correlation function.</p><p><strong>Arguments</strong></p><p>The function accepts 1, 2, or 3 arguments. In all three cases, the objects containing the PCF values are in the final of these arguments either as single instances or as vectors of instances.</p><p><strong>Vectors</strong></p><p>If the PCF values are all vectors, this will assume that these are independent realizations of the same process and will plot a mean and standard deviation. In this case, an optional first argument can be passed to specify the radii. If omitted, then the radii will be inferred from the <code>PCFResult</code> objects or, in the case <code>Vector{&lt;:Real}</code> are passed in, the radii will be the vector indices, i.e. <code>1:length(g)</code>.</p><p><strong>Matrices</strong></p><p>If the PCF values are all matrices, this will assume that each column is a different timepoint and will plot a heatmap of the mean across all samples (each matrix representing a timeseries sample). In this case, two optional first arguments can be passed to specify the timepoints and radii, respectively. If providing these arguments, the radii argument can be omitted ONLY IF the PCF values are passed in as <code>PCFResult</code> objects, i.e., they have the radii stored in the <code>radii</code> field. This ordering is because we assume that the time will be displayed on the x-axis. To swap the axes, transpose the matrices; then, pass in the timepoints as the second argument and the radii as the first argument. If neither are passed in, the radii will be inferred as for the vectors; timepoints will be the indices of the columns of the matrices, i.e. <code>1:size(g, 2)</code>.</p><p><strong>Optional arguments</strong></p><p>When plotting a heatmap, i.e., matrices, <code>pcfplot</code> will use the <code>:tofino</code> colorscheme by default. This can be changed by passing in a keyword argument <code>colorscheme</code> with the desired colorscheme. See the <code>Plots</code>-supported <a href="https://docs.juliaplots.org/latest/generated/colorschemes/">color schemes</a> for more options. So long as <code>color</code> is not user-defined, then <code>pcfplot</code> use this scheme and will further set the color scheme to transition at the pcf value 1 to highlight the transition from depletion to enrichment.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">using PairCorrelationFunction
using Plots
g = [0.5; 1.2; 0.8; 0.7; 0.6; 1.6]
pcfplot(g)</code></pre><pre><code class="language-julia hljs">using PairCorrelationFunction
using Plots
g1 = [0.5; 1.2; 0.8; 0.7; 0.6; 1.6]
g2 = [0.9; 1.0; 1.1; 1.2; 1.3; 1.4]
pcfplot([g1, g2])</code></pre><pre><code class="language-julia hljs">using PairCorrelationFunction
using Plots
g = [0.5 1.2 0.8;
     0.7 0.6 1.6;
     0.9 1.0 1.1;
     1.2 1.3 1.4;
     1.5 1.6 1.7]
pcfplot(g; colorscheme=:cork)</code></pre><pre><code class="language-julia hljs">using PairCorrelationFunction
using Plots
result = PairCorrelationFunction.PCFResult(0:20.0:100.0, [0.1; 0.2; 0.3; 0.4; 0.5])
pcfplot(result)</code></pre><pre><code class="language-julia hljs">using PairCorrelationFunction
using Plots
result1 = PairCorrelationFunction.PCFResult(0:20.0:100.0, [0.1; 0.2; 0.3; 0.4; 0.5])
result2 = PairCorrelationFunction.PCFResult(0:20.0:100.0, [0.6; 0.7; 0.8; 0.9; 1.0])
RESULT = hcat(result1, result2)
pcfplot([100.0, 200.0], RESULT) # use radii in RESULT for y-axis
pcfplot([100.0, 200.0], 0:20.0:100.0, RESULT) # explicitly pass in radii</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/drbergman-lab/PairCorrelationFunction.jl/blob/41c5f537c3acb4af5e9948daa801aec034d302eb/src/PairCorrelationFunction.jl#L401-L468">source</a></section></article></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.10.1 on <span class="colophon-date" title="Wednesday 16 April 2025 19:36">Wednesday 16 April 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
